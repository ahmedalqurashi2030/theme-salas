{# src/views/components/header/header.twig #}

<header class="store-header th-header sticky top-0 z-[999]">
    
    {# 1. الشريط العلوي #}
    <div class="th-topbar py-2 hidden md:block">
        <div class="container flex justify-between items-center">
            <div class="flex gap-4 opacity-90">
                <span><i class="sicon-shipping-fast mx-1"></i> شحن مجاني للطلبات +299 ر.س</span>
            </div>
            <div class="flex items-center gap-4">
                {% component 'footer.menu' with {is_header:true} %}
                {# اللغة والعملة #}
                {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
                    <button onclick="salla.event.dispatch('localization::open')" class="hover:text-gold transition">
                        {{ user.language.name }} | {{ currency.symbol }}
                    </button>
                {% endif %}
            </div>
        </div>
    </div>

    {# 2. الهيدر الرئيسي #}
    <div class="th-main-header py-3">
        <div class="container flex items-center justify-between gap-8">
            
            {# زر الموبايل #}
            <button class="lg:hidden text-2xl text-gray-800" onclick="toggleMobileMenu()">
                <i class="sicon-menu"></i>
            </button>

            {# الشعار #}
            <a href="{{ store.url }}" class="shrink-0">
                <img src="{{ store.logo }}" alt="{{ store.name }}" class="h-10 md:h-12 w-auto object-contain">
            </a>

            {# البحث (تصميم حديث) #}
            <div class="flex-1 max-w-2xl hidden lg:block">
                <salla-search inline oval height="46" placeholder="{{ trans('blocks.header.search_placeholder') }}"></salla-search>
            </div>

            {# الأيقونات #}
            <div class="flex items-center gap-6">
                <button class="lg:hidden text-xl" onclick="salla.event.dispatch('search::open')"><i class="sicon-search"></i></button>
                
                <div class="hidden lg:block">
                    <salla-user-menu avatar-only show-header></salla-user-menu>
                </div>

                <a href="{{ link('wishlist') }}" class="th-icon-btn hidden lg:flex">
                    <i class="sicon-heart"></i>
                    <span class="th-icon-label">المفضلة</span>
                </a>

                <salla-cart-summary class="th-icon-btn cursor-pointer">
                    <div slot="icon" class="relative">
                        <i class="sicon-shopping-bag"></i>
                        <span class="th-badge">{{ cart.items_count }}</span>
                    </div>
                    <span class="th-icon-label hidden lg:block">السلة</span>
                </salla-cart-summary>
            </div>
        </div>
    </div>

    {# 3. الناف بار #}
    <div class="th-navbar hidden lg:block">
        <div class="container h-full">
            {% component 'header.menu' %}
        </div>
    </div>

</header>

{# استدعاء المودالز الضرورية #}
<salla-localization-modal></salla-localization-modal>
{% if store.scope %} <salla-scopes></salla-scopes> {% endif %}


<style>
  /* --- متغيرات الألوان --- */
:root {
    --color-gold: #d4af37;
    --color-dark: #222;
    --color-gray-light: #f9f9f9;
}

/* --- تنسيقات الهيدر العامة --- */
.th-header {
    font-family: 'Tajawal', sans-serif; /* تأكد من وجود الخط */
}

.th-topbar {
    background-color: var(--color-dark);
    color: #fff;
    font-size: 12px;
    padding: 8px 0;
}

.th-topbtn {
    display: flex;
    align-items: center;
    opacity: 0.8;
    transition: 0.3s;
}
.th-topbtn:hover { opacity: 1; }

.th-logo img {
    height: 45px;
    width: auto;
}

/* --- زر السلة --- */
.th-cart-btn {
    position: relative;
    cursor: pointer;
}
.th-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background-color: var(--color-gold);
    color: #fff;
    font-size: 10px;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
}

/* --- الناف بار وزر جميع الأقسام --- */
.th-navbar {
    height: 55px;
    position: relative;
    z-index: 20; /* أقل من الهيدر المثبت */
}

.th-nav-container {
    height: 100%;
}

.th-all-cats-wrapper {
    height: 100%;
    position: relative;
}

.th-all-cats-btn {
    height: 100%;
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 0 20px;
    background-color: var(--color-gray-light);
    border-left: 1px solid #eee;
    border-right: 1px solid #eee;
    cursor: pointer;
    font-weight: 800;
    font-size: 14px;
    color: var(--color-dark);
    transition: 0.3s;
    width: 200px; /* عرض ثابت للجمالية */
}

.th-all-cats-wrapper:hover .th-all-cats-btn {
    background-color: var(--color-gold);
    color: #fff;
}

/* --- الميجا منيو (Mega Menu) --- */
.th-mega-menu {
    position: absolute;
    top: 100%;
    right: 0;
    width: 900px;
    background: #fff;
    border: 1px solid #eee;
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    border-radius: 0 0 8px 8px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
    z-index: 100;
    min-height: 400px;
}

.th-all-cats-wrapper:hover .th-mega-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.th-mega-tab {
    padding: 12px 20px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    color: #555;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #f0f0f0;
    transition: 0.2s;
}

.th-mega-tab:hover, .th-mega-tab.active {
    background-color: #fff;
    color: var(--color-gold);
    border-right: 3px solid var(--color-gold);
    padding-right: 17px; /* تعويض البوردر */
}

.th-mega-pane {
    display: none;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

/* --- إصلاحات عامة --- */
.text-gold { color: var(--color-gold) !important; }
.hover\:text-gold:hover { color: var(--color-gold) !important; }


</style>
<script>
// Tharaa Header/Menu enhancements (Tabs + Mobile Accordion)
// Paste into your main JS bundle (e.g. src/assets/js/app.js)



    // Tharaa Header/Menu enhancements (Tabs + Mobile Accordion)
// Paste into your main JS bundle (e.g. src/assets/js/app.js)


</script>

