{#
| Variable         | Type    | Description                     |
|------------------|---------|---------------------------------|
| cart             | object  |                                 |
| cart.items_count | int     |                                 |
| cart.total       | string  | Formatted total ex: "١٠٠ ر.س"   |
#}

<header class="store-header th-hdr">

    {# (اختياري) إعلان سلة إذا كان متوفر — بدون ما يسبب خطأ لو غير موجود #}
    {% if advertisement is defined and advertisement %}
        {% include 'components.header.advertisement' ignore missing with {advertisement: advertisement} %}
    {% endif %}

    {# Top Shipping Bar (ستايل مثل تصميمك) #}
    <div class="th-hdr__shipping-bar">
        <div class="container th-hdr__shipping-inner">
            شحن مجاني للطلبات التي تزيد عن 299 ريال | تسوّق الآن واستمتع بالخصومات
        </div>
    </div>

    {# Top Nav (نحافظ على محتوى سلة الأصلي) #}
    <div class="top-navbar th-hdr__top-navbar">
        <div class="container flex justify-between th-hdr__top-inner">

            <div class="flex-1 flex items-center rtl:space-x-reverse space-x-2 th-hdr__top-left">

                {# Footer Menu #}
                {% component 'footer.menu' with {is_header:true} %}

                <div class="header-buttons">
                    {# Language & Currency Component #}
                    {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
                        <button type="button" onclick="salla.event.dispatch('localization::open')" class="btn--rounded-gray basis-0">
                            <span class="flag iti__flag iti__{{ user.language.country_code }} rounded-sm"></span>
                            <span class="mx-1.5">|</span> <span>{{ currency.symbol }}</span>
                        </button>
                        <salla-localization-modal></salla-localization-modal>
                    {% endif %}
                </div>

                {# Scopes | Branches #}
                {% if store.scope %}
                    <button class="btn--rounded-gray"
                            onclick="salla.event.dispatch('scopes::open', {'mode': 'default'})">
                        <i class="sicon-location rtl:ml-1 ltr:mr-1"></i> {{ store.scope.name }}
                    </button>
                {% endif %}

                {# Search (Mobile فقط هنا) #}
                <div class="header-search flex-1 lg:hidden th-hdr__search-mobile">
                    <salla-search inline oval height="36"></salla-search>
                </div>
            </div>

            {% component 'footer.contacts' with {is_header:true} %}
        </div>
    </div>

    {# Main Nav (Premium Layout) #}
    <div id="mainnav" class="main-nav-container shadow-default bg-white th-hdr__main">
        <div class="inner bg-inherit">
            <div class="container">
                <div class="flex items-stretch justify-between relative th-hdr__main-inner">

                    {# Left: Burger + Logo + Menu #}
                    <div class="flex items-center th-hdr__left">
                        <a class="lg:hidden mburger mburger--collapse leading-none" href="#mobile-menu">
                            <i class="sicon-menu th-hdr__burger-icon rtl:ml-2.5 ltr:mr-2.5"></i>
                        </a>

                        <a class="navbar-brand th-hdr__brand" href="{{ store.url }}">
                            <img fetchpriority="high" width="100%" height="100%" loading="eager"
                                 src="{{ store.logo }}" alt="{{ store.name }}">
                            {% if is_page('index') %}
                                <h1 class="sr-only">{{ store.name }}</h1>
                            {% else %}
                                <h2 class="sr-only">{{ store.name }}</h2>
                            {% endif %}
                        </a>

                        {# Menu Component (لا نخفيه لأن فيه mobile-menu) #}
                        {% component 'header.menu' %}
                    </div>

                    {# Center: Search (Desktop فقط) #}
                    <div class="hidden lg:flex flex-1 justify-center px-6 th-hdr__search-desktop">
                        <div class="th-hdr__search-wrap">
                            <salla-search inline oval height="44"></salla-search>
                        </div>
                    </div>

                    {# Right: User + Cart (نحافظ على سلوك سلة) #}
                    <div class="flex items-center justify-end th-hdr__actions">
                        {% if user.type=='user' %}
                            <salla-user-menu avatar-only show-header></salla-user-menu>
                        {% else %}
                            <button class="header-btn th-hdr__icon-btn" onclick="salla.event.dispatch('login::open')">
                                <i class="header-btn__icon sicon-user-circle"></i>
                            </button>
                        {% endif %}

                        <salla-cart-summary class="ml-4 rtl:ml-[unset] rtl:mr-4 th-hdr__cart">
                            <i slot="icon" class="header-btn__icon icon sicon-shopping-bag"></i>
                        </salla-cart-summary>
                    </div>

                </div>
            </div>
        </div>
    </div>
</header>

{% if store.scope %}
    <salla-scopes selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"></salla-scopes>
{% endif %}
