{#
| Variable   | Type | Description |
|------------|------|-------------|
| menu       | Menu | Menu Object |
| is_root    | Bool | Is Root Level |
#}

{# --- نسخة الموبايل (Accordion) --- #}
<li class="lg:hidden border-b border-gray-100" {{ menu.attrs|raw }}>
    {% if not menu.has_children %}
        <a href="{{ menu.url }}" class="block py-3 px-4 font-bold text-gray-700">{{ menu.title }}</a>
    {% else %}
        <div class="flex items-center justify-between pr-4 pl-2 py-3">
            <a href="{{ menu.url }}" class="font-bold text-gray-700">{{ menu.title }}</a>
            <button class="w-8 h-8 flex items-center justify-center bg-gray-50 rounded-full" onclick="this.parentElement.nextElementSibling.classList.toggle('hidden')">
                <i class="sicon-keyboard_arrow_down"></i>
            </button>
        </div>
        <ul class="hidden bg-gray-50 px-4 pb-2">
            {% for child in menu.children %}
                {% include _self with { menu: child, is_root: false } %}
            {% endfor %}
        </ul>
    {% endif %}
</li>

{# --- نسخة الكمبيوتر (Cascading Dropdown) --- #}
<li class="hidden lg:flex h-full items-center relative group/item {{ is_root ? '' : 'w-full' }}" {{ menu.attrs|raw }}>
    
    <a href="{{ menu.url }}" class="{{ is_root ? 'h-full flex items-center gap-1 font-bold text-sm text-gray-800 hover:text-gold px-1' : 'flex items-center justify-between w-full px-4 py-3 text-sm text-gray-600 hover:bg-gray-50 hover:text-gold transition' }}">
        <span>{{ menu.title }}</span>
        {% if menu.has_children %}
            <i class="{{ is_root ? 'sicon-keyboard_arrow_down mt-1 text-[10px]' : 'sicon-keyboard_arrow_left text-[10px]' }}"></i>
        {% endif %}
    </a>

    {% if menu.has_children %}
        {# تحديد مكان القائمة: إذا كان جذر تكون تحته، وإذا كان فرع تكون بجانبه #}
        <div class="absolute bg-white border border-gray-100 shadow-lg rounded-lg min-w-[220px] py-2 opacity-0 invisible group-hover/item:opacity-100 group-hover/item:visible transition-all duration-200 z-50
            {{ is_root ? 'top-full right-0 mt-0' : 'top-0 right-full mr-1' }}">
            
            <ul class="flex flex-col">
                {% for child in menu.children %}
                    {% include _self with { menu: child, is_root: false } %}
                {% endfor %}
            </ul>
        </div>
    {% endif %}
</li>