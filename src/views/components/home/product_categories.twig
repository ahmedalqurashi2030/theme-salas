{# ============================================
   Product Categories Component â€“ Niceone Card
   Uses Salla components + slots (image, details, price)
   ============================================ #}

<section class="lifestyle-section" id="section-{{ section_id }}">
	<!-- Decorative Background Halos -->
	<div class="halo halo-1"></div>
	<div class="halo halo-2"></div>

	<div class="section-container">
		<!-- Section Header & Filters -->
		<div class="section-header">
			<div>
				<h2 class="font-bold text-lg md:text-xl">
					{{ section_title|default(trans('components.product_categories.section_title')) }}
				</h2>
				<p class="text-sm text-gray-500">
					{{ trans('components.product_categories.section_description') }}
				</p>
			</div>

			<!-- Category Filter Tabs -->
			{% if component.products|length > 0 %}
				<div class="category-filter">
					<button class="active filter-btn" data-target="all">
						{{ trans('common.all') }}
					</button>
					{% for tab in component.products %}
						{% if tab.category_list and tab.dropdown_list_1|length > 0 %}
							<button class="filter-btn" data-target="cat-{{ tab.category_list.id }}">
								{{ tab.category_title|default(tab.category_list.name|default('')) }}
							</button>
						{% endif %}
					{% endfor %}
				</div>
			{% endif %}
		</div>

		<!-- Products Area -->
		<div class="products-band">
			<div class="cards-strip-wrapper">
				<div class="cards-strip">
					{% for tab in component.products %}
						{% for product in tab.dropdown_list_1 %}
							<div
								class="s-products-slider-card th-card"
								data-category="cat-{{ tab.category_list.id|default('') }}">

								<salla-product-card 
									product="{{ product }}"
									shadow-on-hover
									class="th-card-inner {{ product.is_out_of_stock ? 'is-out-of-stock' : '' }}">

									{# ========== IMAGE SLOT ========== #}
									<div slot="image" class="th-card-image">
										{# Best seller / promotion badge #}
										{% if product.promotion_title or product.is_best_seller %}
											<span class="th-badge th-badge--primary">
												{{ product.promotion_title|default(trans('common.best_seller')) }}
											</span>
										{% endif %}

										<div class="th-card-image-wrapper">
											<img
												src="{{ product.image.url|default(product.image|default('images/s-empty.png'|cdn)) }}"
												alt="{{ product.image.alt|default(product.name) }}"
												loading="lazy">
										</div>

										{# Quick Add floating button #}
										<salla-add-product-button
											class="th-quick-add"
											product-id="{{ product.id }}"
											product-status="{{ product.status }}"
											product-type="{{ product.type }}">
											<span class="sr-only">
												{{ product.add_to_cart_label }}
											</span>
											<i class="sicon-shopping-bag text-base"></i>
										</salla-add-product-button>
									</div>

									{# ========== DETAILS SLOT ========== #}
									<div slot="details" class="th-card-details">
										{% if product.brand %}
											<div class="th-card-brand">
												{{ product.brand.name ?? product.brand }}
											</div>
										{% endif %}

										<div class="th-card-title">
											{{ product.name|default('') }}
										</div>

										{% if product.rating %}
											<div class="th-card-rating">
												<i class="sicon-star2 th-card-rating-icon"></i>
												<span class="th-card-rating-value">
													{{ product.rating.stars ?? product.rating|number }}
												</span>

												{% if product.rating.count %}
													<span class="th-card-rating-count">
														({{ product.rating.count|number }})
													</span>
												{% endif %}
											</div>
										{% endif %}
									</div>

									{# ========== PRICE SLOT ========== #}
									<div slot="price" class="th-card-price">
										{% if product.is_on_sale %}
											<div class="th-card-price-row">
												<span class="th-card-price-final">
													{{ product.sale_price|money }}
												</span>

												<span class="th-card-price-original">
													{{ product.regular_price|money }}
												</span>

												{% set discount_percent = null %}
												{% if product.discount_percentage %}
													{% set discount_percent = product.discount_percentage %}
												{% endif %}

												{% if discount_percent is not null %}
													<span class="th-card-discount-badge">
														-%{{ discount_percent }}
													</span>
												{% endif %}
											</div>
										{% else %}
											<div class="th-card-price-row">
												<span class="th-card-price-final">
													{{ product.price|money }}
												</span>
											</div>
										{% endif %}
									</div>
								</salla-product-card>
							</div>
						{% endfor %}
					{% endfor %}
				</div>
			</div>

			<!-- Scroll Progress Bar -->
			<div class="scroll-bar">
				<div class="scroll-prog"></div>
			</div>
		</div>
	</div>
</section>
