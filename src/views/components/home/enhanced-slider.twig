{#
| Variable                       | Type     | Description
|--------------------------------|----------|------------------------------------------------------
| component                      | object   | Contains merchant settings from twilight.json
| component.is_fullwidth         | boolean  | Full-width mode
| component.auto_play            | boolean  | Slider autoplay
| component.show_pagination      | boolean  | Slider dots
| component.show_controls        | boolean  | Slider arrows
| component.slides               | object[] | List of slides
#}

{# Normalize settings keys to support both underscore and hyphen ids and boolean field objects. #}
{% set is_fullwidth_raw = component['is_fullwidth']|default(component.is_fullwidth|default(false)) %}
{% if is_fullwidth_raw is iterable %}
  {% set is_fullwidth_raw = is_fullwidth_raw.selected|default(is_fullwidth_raw.value|default(false)) %}
{% endif %}

{% set auto_play_raw = component['auto-play']|default(component.auto_play|default(false)) %}
{% if auto_play_raw is iterable %}
  {% set auto_play_raw = auto_play_raw.selected|default(auto_play_raw.value|default(false)) %}
{% endif %}

{% set show_pagination_raw = component['show-pagination']|default(component.show_pagination|default(false)) %}
{% if show_pagination_raw is iterable %}
  {% set show_pagination_raw = show_pagination_raw.selected|default(show_pagination_raw.value|default(false)) %}
{% endif %}

{% set show_controls_raw = component['show-controls']|default(component.show_controls|default(false)) %}
{% if show_controls_raw is iterable %}
  {% set show_controls_raw = show_controls_raw.selected|default(show_controls_raw.value|default(false)) %}
{% endif %}

{% set is_fullwidth = is_fullwidth_raw in [true, 1, '1', 'true'] %}
{% set auto_play = auto_play_raw in [true, 1, '1', 'true'] %}
{% set show_pagination = show_pagination_raw in [true, 1, '1', 'true'] %}
{% set show_controls = show_controls_raw in [true, 1, '1', 'true'] %}
{% set slides = component.slides|default([]) %}


{% if slides|length %}
  <section class="s-block s-block--hero-slider {{ is_fullwidth ? 's-block--full-bg' : '' }}">
    <div class="{{ is_fullwidth ? 'w-full p-0' : 'container' }}">
      <salla-slider
        id="main-slider-{{ position }}"
        type="fullwidth"
        auto-play="{{ auto_play ? 'true' : 'false' }}"
        pagination="{{ show_pagination ? 'true' : 'false' }}"
        show-controls="{{ show_controls ? 'true' : 'false' }}"
        {{ show_controls ? 'controls-outer' : '' }}
        class="s-slider-wrapper fullwidth-slider">
        <div slot="items">
          {% for slide in slides %}
            {% set slide_image = slide['slides.image'] ?? slide.image ?? null %}
            {% set slide_title = slide['slides.title'] ?? slide.title ?? null %}
            {% set slide_description = slide['slides.description'] ?? slide.description ?? null %}
            {% set slide_without_overlay_raw = slide['slides.without_overlay'] ?? slide.without_overlay ?? false %}
            {% set slide_without_overlay = slide_without_overlay_raw in [true, 1, '1', 'true'] %}

            {% if slide_image %}
              <div class="swiper-slide w-full min-h-[300px] lg:min-h-[528px] bg-dark relative">
                <div style="background-image: url('{{ slide_image|e('html_attr') }}');"
                     class="bg-cover bg-center absolute inset-0 z-0"></div>

                {% if not slide_without_overlay %}
                  <div class="overlay-bg absolute inset-0 z-10 bg-black/40"></div>
                {% endif %}

                <div class="flex-center container pb-16 sm:pb-0 home-slider__content relative h-full z-20">
                  <div class="w-4/6 text-center md:w-7/12 lg:w-5/12 text-white">
                    {% if slide_title %}
                      <h2 class="lg:text-title-size font-bold leading-tight mb-4" data-swiper-parallax="-500">
                        {{ slide_title }}
                      </h2>
                    {% endif %}

                    {% if slide_description %}
                      <p class="line-clamp-2 description" data-swiper-parallax="-300">
                        {{ slide_description }}
                      </p>
                    {% endif %}
                  </div>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </salla-slider>
    </div>
  </section>
{% endif %}
