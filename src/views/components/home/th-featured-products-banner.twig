{#
| Variable                 | Type                  | Description                                                                  |
|--------------------------|-----------------------|------------------------------------------------------------------------------|
| component                | object                | Contains merchant settings for fields from twilight.json `component` section |
| component.section_title  | ?string               | Section title                                                                |
| component.banner_image   | string/object         | Banner image                                                                 |
| component.banner_sub     | ?string               | Small badge text                                                             |
| component.banner_title   | ?string               | Banner heading                                                               |
| component.banner_description | ?string           | Banner description                                                           |
| component.button_text    | ?string               | CTA text                                                                     |
| component.button_url     | ?string               | CTA URL                                                                      |
| component.display_all_url| mixed                 | Optional show-all link                                                       |
| component.products       | Product[]             | Selected products                                                            |
| position                 | int                   | Sorting number start from zero                                               |
#}

{% set section_title = component.section_title|default(trans('components.th_featured_products_banner.section_title')) %}
{% set banner_sub = component.banner_sub|default(trans('components.th_featured_products_banner.badge')) %}
{% set banner_title = component.banner_title|default(trans('components.th_featured_products_banner.banner_title')) %}
{% set banner_description = component.banner_description|default(trans('components.th_featured_products_banner.banner_description')) %}
{% set button_text = component.button_text|default(trans('components.th_featured_products_banner.shop_now')) %}
{% set button_url = component.button_url|default('#') %}
{% set show_arrows = component.show_arrows ?? true %}
{% set show_dots = component.show_dots ?? true %}

{% set banner_image = component.banner_image ?? null %}
{% if banner_image and banner_image.url is defined %}
  {% set banner_image = banner_image.url %}
{% elseif banner_image and banner_image.original is defined %}
  {% set banner_image = banner_image.original %}
{% endif %}

{% set selected_products = component.products|default([]) %}
{% set product_ids = [] %}
{% for product in selected_products %}
  {% set id = product.id|default(product) %}
  {% if id %}
    {% set product_ids = product_ids|merge([id]) %}
  {% endif %}
{% endfor %}

{% set display_all = component.display_all_url|default('') %}

{% if product_ids|length %}
<section class="s-block th-featured-products-banner py-8 sm:py-10" id="th-featured-products-banner-{{ position }}">
  <div class="container">
    {% if section_title %}
      <div class="th-featured-products-banner__head mb-4 sm:mb-6 flex items-center justify-between gap-3">
        <h2 class="text-2xl sm:text-3xl font-bold text-primary">{{ section_title }}</h2>

        {% if display_all and display_all != '#' %}
          <a href="{{ display_all }}" class="text-sm sm:text-base font-bold hover:underline">
            {{ trans('components.th_featured_products_banner.shop_all') }}
          </a>
        {% endif %}
      </div>
    {% endif %}

    <div class="th-featured-products-banner__layout grid gap-4 lg:gap-6 lg:grid-cols-[minmax(280px,32%)_1fr]">
      <article class="th-featured-products-banner__promo relative overflow-hidden rounded-2xl min-h-[320px] sm:min-h-[380px] lg:min-h-[380px] order-2 lg:order-1">
        {% if banner_image %}
          <img src="{{ banner_image }}" alt="{{ banner_title ?: section_title }}" loading="lazy" class="absolute inset-0 w-full h-full object-cover" />
        {% endif %}

        <div class="absolute inset-0 bg-gradient-to-r from-black/90 via-black/60 to-black/35"></div>

        <div class="relative z-[1] h-full p-6 sm:p-8 text-white flex flex-col justify-between">
          <div class="space-y-3">
            {% if banner_sub %}
              <span class="inline-flex rounded-md bg-primary text-black font-bold px-3 py-1 text-xs sm:text-sm">{{ banner_sub }}</span>
            {% endif %}

            {% if banner_title %}
              <h3 class="text-2xl sm:text-4xl font-extrabold leading-tight">{{ banner_title }}</h3>
            {% endif %}

            {% if banner_description %}
              <p class="text-base sm:text-lg text-white/90 max-w-[30ch]">{{ banner_description }}</p>
            {% endif %}
          </div>

          {% if button_text %}
            <div class="pt-6">
              <a href="{{ button_url }}" class="btn btn--primary !px-8 !py-3 !rounded-xl !text-base font-bold">{{ button_text }}</a>
            </div>
          {% endif %}
        </div>
      </article>

      <div class="th-featured-products-banner__products order-1 lg:order-2 overflow-hidden">
        <salla-products-slider
          class="th-products-slider"
          source="selected"
          source-value="[{{ product_ids|join(',') }}]"
          block-title="{{ section_title }}"
          slider-id="th-featured-products-banner-{{ position }}-slider"
          show-controls="{{ show_arrows ? 'true' : 'false' }}"
          show-pagination="{{ show_dots ? 'true' : 'false' }}"
          {% if display_all and display_all != '#' %}
            display-all-url="{{ display_all }}"
          {% endif %}
        ></salla-products-slider>
      </div>
    </div>
  </div>
</section>
{% endif %}
