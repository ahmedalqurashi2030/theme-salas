{# Get component data from theme.json #}
{% set section_title = component.section_title|default('تصفح حسب الفئة') %}
{% set section_subtitle = component.section_subtitle|default('') %}
{% set display_mode_raw = component.display_mode.selected[0].label|default(component.display_mode.selected[0].value|default('slider'))|lower %}
{% set display_mode = (display_mode_raw in ['list','قائمة']) ? 'list' : 'slider' %}
{% set autoplay = component.autoplay|default(false) %}
{% set show_controls = component.show_controls|default(true) %}
{% set two_rows = component.two_rows|default(false) %}
{% set items_mobile_raw = component.items_per_view_mobile.selected[0].value|default(component.items_per_view_mobile.selected[0].label|default(component.items_per_view_mobile.value|default(component.items_per_view_mobile|default('3')))) %}
{% set items_mobile = (items_mobile_raw in ['1','2','3','4']) ? items_mobile_raw : '3' %}
{% set items_desktop_raw = component.items_per_view_desktop.selected[0].value|default(component.items_per_view_desktop.selected[0].label|default(component.items_per_view_desktop.value|default(component.items_per_view_desktop|default('6')))) %}
{% set items_desktop = (items_desktop_raw in ['4','5','6','7','8']) ? items_desktop_raw : '6' %}
{% set items = component.items|default([]) %}

{# Generate unique ID for this section instance #}
{% set section_id = 'tharaa-circle-' ~ random() %}

{# Only render if we have items #}
{% if items is not empty %}


	<section class="s-block  tharaa-links-section style-circle {{ display_mode == 'list' ? 'mode-grid' : '' }} {{ two_rows ? 'mode-double' : '' }}" id="{{ section_id }}" data-autoplay="{{ autoplay ? 'true' : 'false' }}" data-items-mobile="{{ items_mobile }}" data-items-desktop="{{ items_desktop }}" style="--th-items-mobile: {{ items_mobile|default('3') }}; --th-items-desktop: {{ items_desktop|default('6') }}; --th-gap: 20px;">

		<div
			class="container">


			{# استخدام المتغيرات الممررة من المكون الأب #}
			{% set alignment = alignment|default('start') %}
			{% set btn_text = btn_text|default('') %}

			{# === بداية المكون === #}
			<div
				class="s-block__header-wrapper {{ alignment == 'center' ? 's-block--center' : '' }}">

				{# 1. Side Bar (يظهر فقط إذا كانت المحاذاة جانبية) #}
				{% if alignment != 'center' %}
					<div class="s-block__side-bar"></div>
				{% endif %}

				{# 2. Titles Container #}
				<div class="s-block__title">
					<div
						class="s-block__title-row">

						{# خط التزيين الأيمن (للوضع المتوسط) #}
						{% if alignment == 'center' %}
							<span class="s-block__line"></span>
						{% endif %}

						<h2 class="s-block__title-head">{{ section_title }}</h2>

						{# خط التزيين الأيسر (للوضع المتوسط) #}
						{% if alignment == 'center' %}
							<span class="s-block__line"></span>
						{% endif %}
					</div>

					{% if section_subtitle %}
						<p class="s-block__title-sub">{{ section_subtitle }}</p>
					{% endif %}
				</div>

				{# 3. Action Button #}
				{% if btn_text %}
					<div class="s-block__action">
						<a href="#" class="btn-custom">
							<span>{{ btn_text }}</span>
							<!-- سهم SVG بسيط للاختبار -->
							<svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 5px;">
								<path d="M19 12H5M12 5l-7 7 7 7"></path>
							</svg>
						</a>
					</div>
				{% endif %}
			</div>
			{# === نهاية المكون === #}


			<div class="tharaa-track-wrapper">

				{% if show_controls %}
					<button class="tharaa-nav-btn btn-prev" aria-label="{{ trans('common.previous') }}">
						<i class="sicon-chevron-{{ user.language.dir == 'rtl' ? 'right' : 'left' }}"></i>
					</button>

					<button class="tharaa-nav-btn btn-next" aria-label="{{ trans('common.next') }}">
						<i class="sicon-chevron-{{ user.language.dir == 'rtl' ? 'left' : 'right' }}"></i>
					</button>
				{% endif %}

				<div
					class="tharaa-track">

					{# Loop through items from theme.json: items[] #}
					{% for item in items %}
						<a
							href="{{ item.url|default('#') }}" class="tharaa-card" aria-label="{{ item.title }}">

							{# Visual Container (Image) - Circle shape via style-circle modifier #}
							<div class="tharaa-card__visual">
								<img class="tharaa-card__img" src="{{ item.image }}" alt="{{ item.title }}" loading="lazy" decoding="async">
							</div>

							{# Content Container (Title + Optional Count) #}
							<div class="tharaa-card__content">
								<span class="tharaa-card__title">{{ item.title }}</span>

								{# Optional: Product count (if available in data) #}
								{% if item.count is defined %}
									<span class="tharaa-card__count">{{ item.count }}</span>
								{% endif %}
							</div>
						</a>
					{% endfor %}

				</div>
			</div>

			<div class="tharaa-progress">
				<div class="tharaa-progress__bar"></div>
			</div>

		</div>
	</section>

{% endif %}
