{# ================================================
   Tharaa Theme â€“ Custom Apple Event Section
   ================================================ #}

{# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø«ÙŠÙ… #}
{% set title          = component.title          ?? 'Ø¹Ø±ÙˆØ¶ Ø¢Ø¨Ù„ Ø§Ù„Ø®Ø§Ø±Ù‚Ø© ÙˆØµÙ„Øª Ø§Ù„Ø¢Ù†.' %}
{% set description    = component.description    ?? 'Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®ØµÙˆÙ…Ø§Øª ÙÙˆØ±ÙŠØ© ØªØµÙ„ Ø¥Ù„Ù‰ 20% Ø¹Ù†Ø¯ Ø´Ø±Ø§Ø¡ Ø£Ø¬Ù‡Ø²Ø© Ù…Ø®ØªØ§Ø±Ø©.' %}
{% set hero_image     = component.hero_image     ?? 'https://i.ibb.co/68v8zN6/Apple-Set-Transparent.png' %}
{% set countdown_end  = component.countdown_end  ?? '' %} 
{% set products       = component.products       ?? [] %}

<section class="s-block th-hero-promo">
    <style>
        /* --- CSS Scoped for Tharaa Apple Section --- */
        .th-hero-promo {
            --th-primary: #0071e3;
            --th-text-main: #1d1d1f;
            --th-text-sub: #555555;
            /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© */
            --th-bg-gradient: linear-gradient(90deg, #feeef1 0%, #eef8ff 100%);
            --th-glass-bg: rgba(255, 255, 255, 0.65);
            --th-glass-border: 1px solid rgba(255, 255, 255, 0.6);
            --th-radius-xl: 32px;
            --th-radius-md: 20px;
            --th-radius-sm: 16px;
            --th-shadow: 0 20px 60px rgba(0, 0, 0, 0.06);
            
            font-family: 'Tajawal', sans-serif;
            direction: rtl;
            text-align: right;
            padding: 40px 0;
            box-sizing: border-box;
            display: block;
        }

        .th-hero-promo * { box-sizing: border-box; }
        .th-hero-promo a { text-decoration: none; }

        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
        .th-hero-promo__card {
            background: var(--th-bg-gradient);
            border-radius: var(--th-radius-xl);
            padding: 50px;
            box-shadow: var(--th-shadow);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 50px;
        }

        /* Ø§Ù„Ø²Ø®Ø±ÙØ© */
        .th-hero-promo__glow {
            position: absolute; width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(255,255,255,0.6) 0%, transparent 70%);
            top: -10%; left: 50%; transform: translateX(-50%);
            z-index: 0; pointer-events: none;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .th-hero-promo__header {
            display: flex; align-items: center; justify-content: space-between;
            gap: 40px; position: relative; z-index: 2;
        }
        .th-content-col { flex: 1; }
        .th-visual-col { flex: 0 0 35%; max-width: 35%; display: flex; justify-content: flex-end; }

        .th-badge {
            display: inline-block; background: rgba(0, 113, 227, 0.1); color: var(--th-primary);
            padding: 6px 14px; border-radius: 30px; font-weight: 700; font-size: 13px;
            margin-bottom: 15px; border: 1px solid rgba(0, 113, 227, 0.15);
        }
        .th-title {
            font-size: 40px; font-weight: 900; color: var(--th-text-main);
            margin-bottom: 15px; line-height: 1.2;
        }
        .th-subtitle {
            font-size: 16px; color: var(--th-text-sub); margin-bottom: 30px; max-width: 90%; line-height: 1.6;
        }

        /* Ø§Ù„Ø¹Ø¯Ø§Ø¯ */
        .th-timer { display: flex; gap: 10px; margin-bottom: 35px; }
        .th-timer__item {
            background: var(--th-glass-bg); backdrop-filter: blur(10px);
            border: var(--th-glass-border); border-radius: var(--th-radius-sm);
            width: 70px; height: 80px; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }
        .th-timer__val { font-size: 26px; font-weight: 800; color: #333; line-height: 1; }
        .th-timer__lbl { font-size: 12px; color: #666; margin-top: 4px; }

        /* Ø§Ù„Ø²Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .th-btn {
            background: var(--th-text-main); color: #fff !important;
            padding: 14px 35px; border-radius: 50px; font-weight: 700; font-size: 15px;
            display: inline-flex; align-items: center; gap: 10px; transition: 0.3s;
        }
        .th-btn:hover { background: var(--th-primary); transform: translateY(-3px); }

        /* Ø§Ù„ØµÙˆØ±Ø© */
        .th-main-img {
            width: 100%; height: auto; object-fit: contain;
            filter: drop-shadow(0 25px 50px rgba(0,0,0,0.15));
            animation: thFloat 6s ease-in-out infinite;
        }

        /* --- ØªØµÙ…ÙŠÙ… Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Custom Product Cards) --- */
        .th-footer { position: relative; z-index: 2; }
        .th-label { font-size: 14px; font-weight: 700; color: #888; margin-bottom: 20px; text-transform: uppercase; }

        .th-products-list {
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;
        }

        /* Ø§Ù„ÙƒØ§Ø±Øª Ø§Ù„Ù…Ø®ØµØµ */
        .th-prod-card {
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: var(--th-radius-md);
            padding: 15px;
            display: flex; align-items: center; gap: 10px;
            transition: 0.3s; cursor: pointer; text-align: right;
            min-height: 90px; position: relative;
            text-decoration: none !important;
        }
        .th-prod-card:hover {
            background: #fff; transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        .th-p-img { width: 45px; height: 45px; object-fit: contain; transition: 0.3s; }
        .th-prod-card:hover .th-p-img { transform: scale(1.1); }

        .th-p-info { flex: 1; display: flex; flex-direction: column; gap: 4px; overflow: hidden; }
        .th-p-title {
            font-size: 11px; font-weight: 700; color: #333;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .th-p-price { font-size: 12px; font-weight: 700; color: var(--th-primary); }

        /* Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ */
        .th-add-btn {
            width: 26px; height: 26px; border-radius: 50%;
            background: var(--th-primary); color: #fff;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; border: none; opacity: 0; transition: 0.3s;
            cursor: pointer; z-index: 2;
        }
        .th-prod-card:hover .th-add-btn { opacity: 1; }

        /* Scrollbar Mobile */
        .th-scroll-bar { display: none; width: 100px; height: 4px; background: rgba(0,0,0,0.05); border-radius: 4px; margin: 15px auto 0; position: relative; overflow: hidden; }
        .th-scroll-thumb { position: absolute; top: 0; right: 0; height: 100%; width: 30%; background: var(--th-primary); border-radius: 4px; }

        @keyframes thFloat { 0% { transform: translateY(0px); } 50% { transform: translateY(-12px); } 100% { transform: translateY(0px); } }

        /* Responsive */
        @media (max-width: 992px) {
            .th-hero-promo__card { padding: 40px 20px; gap: 40px; }
            .th-hero-promo__header { flex-direction: column-reverse; text-align: center; }
            .th-content-col { width: 100%; }
            .th-visual-col { flex: unset; max-width: 80%; width: 100%; justify-content: center; }
            .th-title { font-size: 28px; }
            .th-subtitle { margin: 0 auto 30px; }
            .th-timer { justify-content: center; }
            .th-products-list {
                display: flex; overflow-x: auto; scroll-snap-type: x mandatory;
                padding-bottom: 10px; scrollbar-width: none;
            }
            .th-products-list::-webkit-scrollbar { display: none; }
            .th-prod-card { min-width: 210px; scroll-snap-align: start; }
            .th-add-btn { opacity: 1; }
            .th-scroll-bar { display: block; }
        }
    </style>

    <div class="container">
        <div class="th-hero-promo__card">
            <div class="th-hero-promo__glow"></div>

            <!-- Header -->
            <header class="th-hero-promo__header">
                <div class="th-content-col">
                    <span class="th-badge">ØªØµÙÙŠØ© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¹Ø§Ù…</span>
                    <h2 class="th-title">{{ title }}</h2>
                    <p class="th-subtitle">{{ description }}</p>
                    
                    {% if countdown_end %}
                    <div class="th-timer" data-end="{{ countdown_end }}">
                        <div class="th-timer__item"><span class="th-timer__val" id="th-ss">00</span><span class="th-timer__lbl">Ø«Ø§Ù†ÙŠØ©</span></div>
                        <div class="th-timer__item"><span class="th-timer__val" id="th-mm">00</span><span class="th-timer__lbl">Ø¯Ù‚ÙŠÙ‚Ø©</span></div>
                        <div class="th-timer__item"><span class="th-timer__val" id="th-hh">00</span><span class="th-timer__lbl">Ø³Ø§Ø¹Ø©</span></div>
                        <div class="th-timer__item"><span class="th-timer__val" id="th-dd">00</span><span class="th-timer__lbl">ÙŠÙˆÙ…</span></div>
                    </div>
                    {% endif %}

                    <a href="#" class="th-btn">
                        ØªØµÙØ­ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
                        <i class="fa-solid fa-arrow-left"></i>
                    </a>
                </div>

                <div class="th-visual-col">
                    <img src="{{ hero_image }}" alt="{{ title }}" class="th-main-img">
                </div>
            </header>

            <!-- Footer: Custom Product Cards -->
            <footer class="th-footer">
                <h3 class="th-label">Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h3>
                
                <div class="th-products-list" id="thProductScroll">
                    
                    {# ğŸ”¥ Ù‡Ù†Ø§ Ø§Ù„Ø³Ø­Ø±: Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙƒØ§Ø±Ø¯ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ù„Ø© ğŸ”¥ #}
                    {% for product in products %}
                    <a href="{{ product.url }}" class="th-prod-card" title="{{ product.name }}">
                        
                        <!-- ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ -->
                        <img src="{{ product.image.url }}" alt="{{ product.image.alt }}" class="th-p-img" loading="lazy">
                        
                        <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª -->
                        <div class="th-p-info">
                            <span class="th-p-title">{{ product.name }}</span>
                            <span class="th-p-price">
                                {{ product.sale_price|money }}
                            </span>
                        </div>

                        <!-- Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© (ÙˆØ¸ÙŠÙÙŠ) -->
                        <!-- Ù†Ø³ØªØ®Ø¯Ù… salla-cart-add Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· -->
                        <button type="button" 
                                class="th-add-btn" 
                                onclick="event.preventDefault(); salla.cart.addItem({product_id: {{ product.id }}}).then(() => salla.helpers.modal.toast('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©'))">
                            <i class="fa-solid fa-plus"></i>
                        </button>
                    </a>
                    {% else %}
                        <!-- Ù…Ø«Ø§Ù„ ÙˆÙ‡Ù…ÙŠ ÙÙŠ Ø­Ø§Ù„ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª (Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙ‚Ø·) -->
                        <div class="th-prod-card">
                            <img src="https://assets.stickpng.com/images/580b57fcd9996e24bc43c51f.png" class="th-p-img">
                            <div class="th-p-info">
                                <span class="th-p-title">iPad Mini 6</span>
                                <span class="th-p-price">2,499 Ø±.Ø³</span>
                            </div>
                            <button class="th-add-btn"><i class="fa-solid fa-plus"></i></button>
                        </div>
                         <div class="th-prod-card">
                            <img src="https://pngimg.com/d/apple_watch_PNG108990.png" class="th-p-img">
                            <div class="th-p-info">
                                <span class="th-p-title">Watch Ultra</span>
                                <span class="th-p-price">3,199 Ø±.Ø³</span>
                            </div>
                            <button class="th-add-btn"><i class="fa-solid fa-plus"></i></button>
                        </div>
                         <div class="th-prod-card">
                            <img src="https://pngimg.com/d/macbook_PNG6.png" class="th-p-img">
                            <div class="th-p-info">
                                <span class="th-p-title">MacBook Air</span>
                                <span class="th-p-price">4,599 Ø±.Ø³</span>
                            </div>
                            <button class="th-add-btn"><i class="fa-solid fa-plus"></i></button>
                        </div>
                         <div class="th-prod-card">
                            <img src="https://assets.stickpng.com/images/635a6b0c239d42f83c072e94.png" class="th-p-img">
                            <div class="th-p-info">
                                <span class="th-p-title">iPhone 14</span>
                                <span class="th-p-price">3,799 Ø±.Ø³</span>
                            </div>
                            <button class="th-add-btn"><i class="fa-solid fa-plus"></i></button>
                        </div>
                         <div class="th-prod-card">
                            <img src="https://purepng.com/public/uploads/large/purepng.com-imac-screen-215appleimac215-inch-screen-215-inchdesktoppccomputermonitor-17015283489280x60m.png" class="th-p-img">
                            <div class="th-p-info">
                                <span class="th-p-title">iMac 24</span>
                                <span class="th-p-price">5,899 Ø±.Ø³</span>
                            </div>
                            <button class="th-add-btn"><i class="fa-solid fa-plus"></i></button>
                        </div>
                    {% endfor %}
                    
                </div>

                <div class="th-scroll-bar">
                    <div class="th-scroll-thumb" id="thScrollThumb"></div>
                </div>
            </footer>
        </div>
    </div>
</section>

<script>
    // JS: Timer & Scroll Logic
    (function(){
        // Timer
        var timerEl = document.querySelector('.th-timer');
        if(timerEl && timerEl.dataset.end) {
            var endDate = new Date(timerEl.dataset.end);
            setInterval(function() {
                var now = new Date().getTime();
                var d = endDate - now;
                if(d < 0) return;
                var dd = Math.floor(d / (86400000));
                var hh = Math.floor((d % (86400000)) / (3600000));
                var mm = Math.floor((d % (3600000)) / (60000));
                var ss = Math.floor((d % (60000)) / 1000);
                document.getElementById("th-dd").innerText = dd < 10 ? "0"+dd : dd;
                document.getElementById("th-hh").innerText = hh < 10 ? "0"+hh : hh;
                document.getElementById("th-mm").innerText = mm < 10 ? "0"+mm : mm;
                document.getElementById("th-ss").innerText = ss < 10 ? "0"+ss : ss;
            }, 1000);
        }

        // Scroll
        var scroller = document.getElementById('thProductScroll');
        var thumb = document.getElementById('thScrollThumb');
        var track = document.querySelector('.th-scroll-bar');
        if(scroller && thumb && track) {
            scroller.addEventListener('scroll', function() {
                var scrollW = scroller.scrollWidth - scroller.clientWidth;
                var scrolled = Math.abs(scroller.scrollLeft);
                var trackW = track.clientWidth - thumb.clientWidth;
                var move = (scrolled / scrollW) * trackW;
                thumb.style.transform = 'translateX(-' + move + 'px)';
            });
        }
    })();
</script>