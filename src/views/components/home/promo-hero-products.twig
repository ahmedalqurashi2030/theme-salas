{# ================================================
  Tharaa Theme â€“ Promo Hero + Products
  Path: home.promo-hero-products
================================================ #}

{# 1. Ù‚Ø±Ø§Ø¡Ø© Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù‚Ø³Ù… Ù…Ù† twilight.json #}
{% set title          = component.title          ?? '' %}
{% set description    = component.description    ?? '' %}
{% set hero_image     = component.hero_image     ?? '' %}
{% set countdown_label = component.countdown_label ?? '' %}
{% set products       = component.products       ?? [] %}
{% set show_countdown = component.show_countdown ?? false %}
{% set show_rating    = component.show_price     ?? true %}
{% set countdown_end  = component.countdown_end  ?? '' %}
{% set button_text    = component.button_text    ?? '' %}
{% set button_link    = component.button_link    ?? '' %}

<section class="s-block th-hero-promo">
    <div class="container">
        <div class="th-hero-promo__card">
            <div class="th-hero-promo__glow"></div>

            {# ====== Header: Ø§Ù„Ù†Øµ + ØµÙˆØ±Ø© Ø§Ù„Ù‡ÙŠØ±Ùˆ ====== #}
            <header class="th-hero-promo__header">
                
                {# Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù†Øµ #}
                <div class="th-hero-promo__content-col">

                    {# Ø´Ø§Ø±Ø© ØµØºÙŠØ±Ø© ÙÙˆÙ‚ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ù†Ø³ØªØ®Ø¯Ù… Ù†Øµ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ ÙƒØ¨Ø§Ø¯Ø¬) #}
                    {% if countdown_label %}
                        <span class="th-hero-promo__badge">
                            {{ countdown_label }}
                        </span>
                    {% endif %}

                    {# Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ #}
                    {% if title %}
                        <h2 class="th-hero-promo__title">
                            {{ title }}
                        </h2>
                    {% endif %}

                    {# Ø§Ù„ÙˆØµÙ â€“ ÙŠØ£ØªÙŠ Ù…Ù† richtext #}
                    {% if description %}
                        <p class="th-hero-promo__subtitle">
                            {{ description|raw }}
                        </p>
                    {% endif %}

                    {# Ø§Ù„Ø¹Ø¯Ù‘ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ â€“ Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ show_countdown + countdown_end #}
                    {% if show_countdown and countdown_end %}
                        <div class="th-timer"
                             data-countdown-end="{{ countdown_end }}">
                            <div class="th-timer__item">
                                <span class="th-timer__val" id="th-ss">00</span>
                                <span class="th-timer__lbl">Ø«Ø§Ù†ÙŠØ©</span>
                            </div>
                            <div class="th-timer__item">
                                <span class="th-timer__val" id="th-mm">00</span>
                                <span class="th-timer__lbl">Ø¯Ù‚ÙŠÙ‚Ø©</span>
                            </div>
                            <div class="th-timer__item">
                                <span class="th-timer__val" id="th-hh">00</span>
                                <span class="th-timer__lbl">Ø³Ø§Ø¹Ø©</span>
                            </div>
                            <div class="th-timer__item">
                                <span class="th-timer__val" id="th-dd">00</span>
                                <span class="th-timer__lbl">ÙŠÙˆÙ…</span>
                            </div>
                        </div>
                    {% endif %}

                    {# Ø²Ø± Ø§Ù„Ø¯Ø¹ÙˆØ© Ù„Ø§ØªØ®Ø§Ø° Ø¥Ø¬Ø±Ø§Ø¡ #}
                    {% if button_text and button_link %}
                        <a href="{{ button_link }}"
                           class="th-btn s-button s-button--primary">
                            {{ button_text }}
                            {# ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø³Ù„Ø© Ø¥Ù† Ø£Ø­Ø¨Ø¨Øª #}
                            <i class="fa-solid fa-arrow-left"></i>
                        </a>
                    {% endif %}
                </div>

                {# Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙˆØ±Ø© (ØµÙˆØ±Ø© Ø§Ù„Ù‡ÙŠØ±Ùˆ) #}
                <div class="th-hero-promo__visual-col">
                    {% if hero_image %}
                        <img src="{{ hero_image }}"
                             alt="{{ title }}"
                             class="th-hero-promo__main-img"
                             loading="lazy">
                    {% endif %}
                </div>
            </header>

            {# ====== Footer: Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ====== #}
            {% if products is iterable and products|length %}
                <footer class="th-hero-promo__footer">
                    <h3 class="th-hero-promo__label">
                        Ø§Ù„Ø£ÙƒØ«Ø± Ø·Ù„Ø¨Ø§Ù‹ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
                    </h3>

                    <div class="th-products-list" id="thProductScroll">
                        {# Ù†Ø³ØªØ®Ø¯Ù… Web Component Ø§Ù„Ø±Ø³Ù…ÙŠ salla-product-card #}
                        {% for product in products %}
                            <salla-product-card
                                class="th-product-card"
                                product="{{ product|json_encode|e('html_attr') }}"
                                show-price="true"
                                show-rating="{{ show_rating ? 'true' : 'false' }}"
                                show-add-button="true">
                            </salla-product-card>
                        {% endfor %}
                    </div>

                    {# Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± ÙÙŠ Ø§Ù„Ø¬ÙˆØ§Ù„ #}
                    <div class="th-scroll-bar">
                        <div class="th-scroll-thumb" id="thScrollThumb"></div>
                    </div>
                </footer>
            {% endif %}
        </div>
    </div>
</section>


{# =================== JS Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù‚Ø³Ù… =================== #}
<script>
(function () {
    var sections = document.querySelectorAll('.th-hero-promo');
    if (!sections.length) return;

    for (var i = 0; i < sections.length; i++) {
        (function (section) {

            // -------- 1) Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ --------
            var countdownWrapper = section.querySelector('.th-hero-promo__countdown');
            if (countdownWrapper) {
                var endAttr = countdownWrapper.getAttribute('data-countdown-end');
                if (endAttr) {
                    var endDate = new Date(endAttr);
                    if (!isNaN(endDate.getTime())) {

                        var ddEl = countdownWrapper.querySelector('[data-unit="dd"]');
                        var hhEl = countdownWrapper.querySelector('[data-unit="hh"]');
                        var mmEl = countdownWrapper.querySelector('[data-unit="mm"]');
                        var ssEl = countdownWrapper.querySelector('[data-unit="ss"]');

                        function pad(num) {
                            return num < 10 ? '0' + num : '' + num;
                        }

                        function update() {
                            var now = new Date().getTime();
                            var diff = endDate.getTime() - now;

                            if (diff <= 0) {
                                if (ddEl) ddEl.textContent = '00';
                                if (hhEl) hhEl.textContent = '00';
                                if (mmEl) mmEl.textContent = '00';
                                if (ssEl) ssEl.textContent = '00';
                                countdownWrapper.classList.add('th-timer--finished');
                                return;
                            }

                            var dayMs  = 24 * 60 * 60 * 1000;
                            var hourMs = 60 * 60 * 1000;
                            var minMs  = 60 * 1000;

                            var days  = Math.floor(diff / dayMs);
                            var hours = Math.floor((diff % dayMs) / hourMs);
                            var mins  = Math.floor((diff % hourMs) / minMs);
                            var secs  = Math.floor((diff % minMs) / 1000);

                            if (ddEl) ddEl.textContent = pad(days);
                            if (hhEl) hhEl.textContent = pad(hours);
                            if (mmEl) mmEl.textContent = pad(mins);
                            if (ssEl) ssEl.textContent = pad(secs);
                        }

                        update();
                        setInterval(update, 1000);
                    }
                }
            }

            // -------- 2) Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙƒÙˆÙ„ ÙÙŠ Ø§Ù„Ø¬ÙˆØ§Ù„ --------
            var scroller = section.querySelector('.th-products-list');
            var track    = section.querySelector('.th-scroll-bar');
            var thumb    = section.querySelector('.th-scroll-thumb');

            if (scroller && track && thumb) {
                scroller.addEventListener('scroll', function () {
                    var scrollWidth = scroller.scrollWidth - scroller.clientWidth;
                    if (scrollWidth <= 0) {
                        thumb.style.transform = 'translateX(0)';
                        return;
                    }

                    var scrolled   = Math.abs(scroller.scrollLeft);
                    var trackWidth = track.clientWidth - thumb.clientWidth;
                    var move       = (scrolled / scrollWidth) * trackWidth;

                    thumb.style.transform = 'translateX(-' + move + 'px)';
                });
            }

        })(sections[i]);
    }
})();
</script>

<style>
        /* --- ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª (Scoped Variables) --- */
        .th-hero-promo {
            /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
            --th-primary: #0071e3;
            --th-text-main: #1d1d1f;
            --th-text-sub: #555555;
            
            /* ğŸ”¥ğŸ”¥ Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ù„ÙˆÙ†ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¨Ø§Ù„Ø¶Ø¨Ø· (ÙˆØ±Ø¯ÙŠ Ø¥Ù„Ù‰ Ø£Ø²Ø±Ù‚) ğŸ”¥ğŸ”¥ */
            --th-bg-gradient: linear-gradient(90deg, #feeef1 0%, #eef8ff 100%);
            
            /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø²Ø¬Ø§Ø¬ ÙˆØ§Ù„Ø¸Ù„Ø§Ù„ */
            --th-glass-bg: rgba(255, 255, 255, 0.65);
            --th-glass-border: 1px solid rgba(255, 255, 255, 0.6);
            --th-radius-xl: 32px;
            --th-radius-md: 20px;
            --th-radius-sm: 16px;
            --th-shadow: 0 20px 60px rgba(0, 0, 0, 0.06);
            
            /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø· ÙˆØ§Ù„Ø§ØªØ¬Ø§Ù‡ */
          
        }

        /* ØªØµÙÙŠØ± Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµØ­ÙŠØ­ */

        /* --- 1. Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Card) --- */
        .th-hero-promo__card {
            background: var(--th-bg-gradient); /* ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø®Ù„ÙÙŠØ© Ù‡Ù†Ø§ */
            border-radius: var(--th-radius-xl);
            padding: 50px;
            box-shadow: var(--th-shadow);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 50px;
        }

        /* Ø²Ø®Ø±ÙØ© Ø¥Ø¶Ø§Ø¡Ø© Ø®ÙÙŠÙØ© ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¬Ù…Ø§Ù„ÙŠØ© */
        .th-hero-promo__glow {
            position: absolute;
            width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(255,255,255,0.6) 0%, transparent 70%);
            top: -10%; left: 50%;
            transform: translateX(-50%);
            z-index: 0;
            pointer-events: none;
        }

        /* --- 2. Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø£Ø³ (Header Area) --- */
        .th-hero-promo__header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 40px;
            position: relative;
            z-index: 2;
        }

        /* Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù†ØµÙˆØµ (ÙŠØ£Ø®Ø° Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©) */
        .th-hero-promo__content-col {
            flex: 1;
        }

        /* Ø¹Ù…ÙˆØ¯ Ø§Ù„ØµÙˆØ±Ø© (Ù…Ø­Ø¯Ø¯ Ø¨Ù€ 35% Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙˆØ§Ø²Ù†) */
        .th-hero-promo__visual-col {
            flex: 0 0 35%;
            max-width: 35%;
            display: flex;
            justify-content: flex-end;
            position: relative;
        }

        /* Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†ØµÙŠØ© */
        .th-hero-promo__badge {
            display: inline-block;
            background: rgba(0, 113, 227, 0.1);
            color: var(--th-primary);
            padding: 6px 14px;
            border-radius: 30px;
            font-weight: 700; font-size: 13px;
            margin-bottom: 15px;
            border: 1px solid rgba(0, 113, 227, 0.15);
        }

        .th-hero-promo__title {
            font-size: 40px;
            font-weight: 900;
            color: var(--th-text-main);
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .th-hero-promo__subtitle {
            font-size: 16px;
            color: var(--th-text-sub);
            margin-bottom: 30px;
            max-width: 90%;
            line-height: 1.6;
        }

        /* Ø§Ù„Ø¹Ø¯Ø§Ø¯ */
        .th-timer {
            display: flex; gap: 10px; margin-bottom: 35px;
        }
        .th-timer__item {
            background: var(--th-glass-bg);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            border: var(--th-glass-border);
            border-radius: var(--th-radius-sm);
            width: 70px; height: 80px;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }
        .th-timer__val { font-size: 26px; font-weight: 800; color: #333; line-height: 1; }
        .th-timer__lbl { font-size: 12px; color: #666; margin-top: 4px; }

        /* Ø§Ù„Ø²Ø± */
        .th-btn {
            background: var(--th-text-main);
            color: #fff;
            padding: 14px 35px;
            border-radius: 50px;
            font-weight: 700; font-size: 15px;
            display: inline-flex; align-items: center; gap: 10px;
            transition: 0.3s;
            border: none; cursor: pointer;
        }
        .th-btn:hover {
            background: var(--th-primary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .th-hero-promo__main-img {
            width: 100%;
            height: auto;
            object-fit: contain;
            filter: drop-shadow(0 25px 50px rgba(0,0,0,0.15));
            animation: thFloat 6s ease-in-out infinite;
        }

        /* --- 3. Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Footer Area) --- */
        .th-hero-promo__footer {
            position: relative;
            z-index: 2;
        }

        .th-hero-promo__label {
            font-size: 14px; font-weight: 700; color: #888;
            margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px;
        }

        .th-products-list {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
        }

        .th-product-card {
            background: rgba(255,255,255,0.5); /* Ø´ÙØ§ÙÙŠØ© Ø®ÙÙŠÙØ© Ù„ØªØ¸Ù‡Ø± Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…Ù„ÙˆÙ†Ø© */
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: var(--th-radius-md);
            padding: 15px;
            display: flex; align-items: center; gap: 10px;
            transition: 0.3s; cursor: pointer;
            min-height: 90px;
        }
        .th-product-card:hover {
            background: #fff;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        .th-product-card__img { width: 45px; height: 45px; object-fit: contain; transition: 0.3s; }
        .th-product-card:hover .th-product-card__img { transform: scale(1.1); }

        .th-product-card__info { flex: 1; display: flex; flex-direction: column; gap: 3px; }
        .th-product-card__title { font-size: 12px; font-weight: 700; color: #333; }
        .th-product-card__price { font-size: 13px; font-weight: 700; color: var(--th-primary); }

        .th-product-card__add {
            width: 26px; height: 26px; border-radius: 50%;
            background: var(--th-primary); color: #fff;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; border: none; opacity: 0; transition: 0.3s;
        }
        .th-product-card:hover .th-product-card__add { opacity: 1; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± (Mobile Only) */
        .th-scroll-bar {
            display: none;
            width: 100px; height: 4px;
            background: rgba(0,0,0,0.05);
            border-radius: 4px;
            margin: 15px auto 0;
            position: relative;
            overflow: hidden;
        }
        .th-scroll-thumb {
            position: absolute; top: 0; right: 0;
            height: 100%; width: 30%;
            background: var(--th-primary);
            border-radius: 4px;
        }

        /* --- Keyframes --- */
        @keyframes thFloat {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-12px); }
            100% { transform: translateY(0px); }
        }

        /* --- Responsive (Mobile) --- */
        @media (max-width: 992px) {
            .th-hero-promo__card { padding: 40px 20px; gap: 40px; }
            .th-hero-promo__header { flex-direction: column-reverse; text-align: center; }
            
            .th-hero-promo__content-col { width: 100%; }
            .th-hero-promo__visual-col { flex: unset; max-width: 80%; width: 100%; justify-content: center; }
            
            .th-hero-promo__title { font-size: 28px; }
            .th-hero-promo__subtitle { margin: 0 auto 30px; }
            .th-timer { justify-content: center; }
            
            .th-products-list {
                display: flex; overflow-x: auto;
                scroll-snap-type: x mandatory;
                padding-bottom: 10px;
                scrollbar-width: none;
            }
            .th-products-list::-webkit-scrollbar { display: none; }
            .th-product-card { min-width: 210px; scroll-snap-align: start; }
            .th-product-card__add { opacity: 1; }
            .th-scroll-bar { display: block; }
        }
    </style>
