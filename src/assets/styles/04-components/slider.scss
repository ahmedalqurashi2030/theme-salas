salla-slider {
  @apply block;

  &.details-slider {
    .s-slider-container {
      @apply bg-white border-[1px] rounded-md;
    }

    .swiper-slide {
      @apply relative rounded-md bg-white ring-1 ring-inset ring-gray-100;
    }

    salla-button.btn--wishlist {
      @apply absolute rtl:right-4 ltr:left-4 bottom-4 z-[2] sm:hidden;
    }

    .s-slider-block__title-nav {
      @apply hidden sm:flex;
    }

    /* --- التعديل الاحترافي للصور الجانبية على اليمين (Desktop) --- */
    @media (min-width: 1024px) {
      display: flex !important;
      flex-direction: row !important;
      @apply gap-4 items-start;

      /* تحديد ارتفاع أقصى يتناسب مع الشاشة لضمان عدم تمدد القائمة جانبياً */
      max-height: 750px;

      // التحكم في الاتجاهات لضمان بقاء الصور على اليمين دائماً
      &:where([dir="rtl"], [dir="rtl"] *) {
        .s-slider-thumbs {
          order: 1;
        }

        .s-slider-container {
          order: 2;
        }
      }

      &:where([dir="ltr"], [dir="ltr"] *) {
        .s-slider-container {
          order: 1;
        }

        .s-slider-thumbs {
          order: 2;
        }
      }

      // حاوية الصور المصغرة
      .s-slider-thumbs {
        @apply w-24 shrink-0 m-0 !important;
        /* منع القائمة من تخطي ارتفاع الصورة الكبيرة */
        height: 100% !important;
        max-height: 100% !important;
        overflow-y: auto !important;
        /* تفعيل التمرير الداخلي */
        scrollbar-width: none;

        /* إخفاء شريط التمرير لفايرفوكس */
        &::-webkit-scrollbar {
          display: none;
        }

        /* إخفاء شريط التمرير لكروم وسافاري */

        .swiper-wrapper {
          @apply flex-col h-auto !important;
          transform: none !important;
          /* نوقف حركة السلايدر التلقائية ليعمل كقائمة */
          display: flex !important;
        }

        .swiper-slide {
          @apply mb-3 rounded-md overflow-hidden cursor-pointer transition-all duration-300;
          @apply border border-gray-100 opacity-60;
          height: 120px !important;
          /* ارتفاع ثابت لكل صورة مصغرة */
          width: 100% !important;

          &:hover {
            @apply opacity-100;
          }

          &-thumb-active {
            @apply opacity-100 border-primary shadow-sm;
            border-width: 2px !important;
          }

          img {
            @apply w-full h-full object-cover;
            display: block;
          }
        }

        /*
         * بعض القوالب تضيف عنصر داخلي باسم slide--one-fourth داخل السلايد،
         * ومع h-auto قد تظهر الصورة كشريط صغير.
         * لذلك نثبت الأبعاد هنا لضمان عرض كل المصغرات بشكل صحيح.
         */
        .product-thumb-item,
        .slide--one-fourth {
          height: 120px !important;
          min-height: 84px;
          width: 100% !important;
          max-width: none !important;
          aspect-ratio: 1 / 1;

          img {
            width: 100% !important;
            height: 100% !important;
            object-fit: cover;
            display: block;
          }
        }

        .product-thumb-item__img {
          width: 100% !important;
          height: 100% !important;
          object-fit: cover;
          display: block;
        }

        // إخفاء الأسهم لأن التمرير سيكون بالماوس
        .s-slider-button-next,
        .s-slider-button-prev {
          @apply hidden !important;
        }
      }

      // حاوية الصورة الكبيرة
      .s-slider-container {
        @apply flex-1 w-full !important;
        height: auto;
      }
    }

    &.s-slider-vertical {
      @media (min-width: 768px) and (max-width: 1023px) {
        &:where([dir="rtl"], [dir="rtl"] *) {
          .s-slider-container {
            order: 2;
          }

          .s-slider-thumbs {
            order: 1;
            margin-left: 15px;
            margin-right: 0;
          }
        }
      }
    }
  }

  .slide--one-fourth {
    @apply h-auto w-full sm:w-1/2 md:w-1/3 lg:w-1/4 max-w-[250px] sm:max-w-[320px];
  }

  .slide--one-sixth {
    @apply w-1/2 sm:w-2/6 md:w-1/4 lg:w-1/6;
  }


  // Fix Flickering in Safari 
  .swiper-slide {
    -webkit-transform: translateZ(0);
    -webkit-backface-visibility: hidden;
  }
}

.promotion-title {
  @apply absolute z-10 top-4 rtl:right-0 ltr:left-0 font-bold text-sm bg-red-400 text-white rtl:rounded-l-md ltr:rounded-r-md;
  @apply w-auto m-0 px-3 py-2 #{!important};
}

.home-slider {
  &__slide {
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;

    &:not(.loaded) {
      .overlay {
        opacity: 0;
      }
    }
  }
}

// Photos block slider
salla-slider.photos-slider {
  .swiper {
    @apply w-full mx-0;
  }

  &:not(.hydrated)>div {
    @apply justify-center;
  }

  .swiper-slide {
    @apply h-auto w-[80%] relative rounded-md overflow-hidden mx-2 md:mx-3 lg:mx-4;
  }
}

.swiper:not(.swiper-initialized) {
  .swiper-button {
    opacity: 0;
  }
}

// testimonials-slider
.s-block--testimonials {
  &.container {
    @apply p-0 lg:px-2.5;
  }

  .s-slider-block__title {
    @apply px-2.5 lg:px-0;

    &-nav {
      @apply hidden lg:flex max-w-[88%] top-[65%] #{!important};

      button {
        @apply border-gray-100 shadow-gray-300 #{!important};
      }
    }
  }
}

.testimonials-slider {
  @apply transition-opacity;

  .swiper:not(.swiper-initialized) {
    @apply opacity-0;
  }

  .swiper {
    @apply rtl:pl-12 ltr:pr-12 rtl:lg:pl-0 ltr:lg:pr-0 rtl:pr-5 ltr:pl-5 rtl:lg:pr-0 ltr:lg:pl-0;

    @media (min-width: 1024px) {
      margin-left: -200px;
      margin-right: -200px;
    }

    @media (min-width: 1024px) {
      .s-slider-button-prev {
        margin-left: 200px;
      }

      .s-slider-button-next {
        margin-right: 200px;
      }
    }
  }

  .testimonial {
    height: 100%;
    @apply shadow-default lg:shadow-none flex relative p-6 lg:p-10 bg-white rounded-l-md transition-opacity opacity-60;

    &__inner {
      @apply flex items-center;
    }

    &__avatar {
      @apply w-20 h-20 rounded-full overflow-hidden shrink-0;
    }

    &__icon {
      @apply absolute rtl:left-8 ltr:right-8 rtl:sm:left-12 ltr:sm:right-12 rtl:lg:left-8 ltr:lg:right-8 top-4 text-4xl sm:text-5xl text-primary;
    }

    &__text p,
    &__rating {
      display: none;
    }
  }

  .swiper-slide {
    @apply overflow-hidden px-2.5 lg:px-3.75;
    width: 20%;
    height: auto;

    &:not(.swiper-slide-active) {
      .testimonial {
        &__avatar {
          @apply mb-8;
        }

        &__inner {
          @apply flex-col items-center text-center relative;
        }

        &__icon {
          @apply -top-8 left-1/2 -translate-x-1/2 text-2xl;
        }
      }
    }
  }

  .swiper-slide-prev {
    .testimonial {
      @apply items-center justify-end;
      padding-inline-end: 7%;
    }
  }

  .swiper-slide-next {
    .testimonial {
      @apply items-center justify-start;
      padding-inline-start: 7%;
    }
  }

  .swiper-slide-active {
    width: 60%;

    .testimonial {
      box-shadow: 5px 0 0 0 var(--color-main);
      @apply opacity-100 rtl:lg:pl-24 ltr:lg:pr-24;

      &__inner {
        @apply w-full;

        @media (max-width: 1024px) {
          @apply flex-col items-center justify-center text-center;

          .testimonial__avatar {
            @apply mb-3 mx-0;
          }
        }
      }

      &__avatar {
        @apply rtl:ml-6 ltr:mr-6;
      }

      &__info {
        @apply mb-2 lg:mb-0;
      }

      &__rating,
      &__text p {
        display: block;
      }
    }
  }

  // navigation arrows
  .s-slider--nav-arrow {
    @apply hidden lg:flex translate-y-1/2;
    right: 17%;
    top: 35%;

    &.s-slider-next {
      @apply rtl:right-auto ltr:left-auto;
      left: 17%;
    }

    .ltr & {
      left: 17%;
      right: auto;

      &.s-slider-next {
        right: 17%;
        left: auto
      }
    }
  }
}

/*
 * Native testimonials refinement:
 * scoped to the original component wrapper class to avoid side effects.
 */
.s-block--testimonials.th-testimonials-native {
  --th-testimonials-bg-start: #f8faff;
  --th-testimonials-bg-end: #f3f6fc;
  --th-testimonials-border: #e4ebf5;
  --th-testimonials-card-shadow: 0 14px 30px rgba(15, 23, 42, 0.08);
  --th-testimonials-ease: cubic-bezier(0.22, 1, 0.36, 1);

  border: 1px solid var(--th-testimonials-border);
  border-radius: 24px;
  background: linear-gradient(180deg, var(--th-testimonials-bg-start) 0%, var(--th-testimonials-bg-end) 100%);
  @apply px-3 sm:px-4 lg:px-5 py-8 sm:py-10;

  .s-slider-block__title {
    @apply px-0 mb-6 sm:mb-8 text-center;

    h2 {
      color: var(--color-text);
      @apply mb-2 text-2xl sm:text-3xl lg:text-4xl font-extrabold leading-tight;
    }

    p {
      max-width: 62ch;
      margin-inline: auto;
      color: var(--color-gray-text);
      @apply text-sm sm:text-base leading-7;
    }
  }

  .s-slider-block__title-nav {
    @apply static mt-4 justify-center max-w-none #{!important};

    button {
      border-color: var(--th-testimonials-border) !important;
      box-shadow: none !important;
    }
  }

  .testimonials-slider {
    .swiper {
      margin-inline: 0 !important;
      padding: 6px 2px 52px !important;
    }

    .swiper-slide,
    .swiper-slide-active {
      width: auto !important;
      @apply px-2 lg:px-2.5;
    }

    .testimonial {
      border: 1px solid var(--th-testimonials-border);
      box-shadow: var(--th-testimonials-card-shadow);
      opacity: 1;
      transition:
        transform 260ms var(--th-testimonials-ease),
        box-shadow 260ms var(--th-testimonials-ease),
        border-color 260ms var(--th-testimonials-ease);
      @apply flex h-full flex-col rounded-2xl bg-white p-5 sm:p-6;
    }

    .swiper-slide .testimonial:hover,
    .swiper-slide-active .testimonial {
      border-color: #d6e0ee;
      box-shadow: 0 18px 36px rgba(15, 23, 42, 0.12);
      transform: translateY(-3px);
    }

    .swiper-slide-prev .testimonial,
    .swiper-slide-next .testimonial,
    .swiper-slide-active .testimonial {
      padding-inline: 1.5rem;
      @apply justify-start;
    }

    .testimonial__inner,
    .swiper-slide:not(.swiper-slide-active) .testimonial__inner,
    .swiper-slide-active .testimonial__inner {
      @apply flex w-full flex-col items-start gap-3 text-start;
    }

    .testimonial__avatar,
    .swiper-slide:not(.swiper-slide-active) .testimonial__avatar,
    .swiper-slide-active .testimonial__avatar {
      margin: 0;
      border: 1px solid #e2e8f0;
      @apply w-12 h-12 rounded-full overflow-hidden shrink-0;
    }

    .testimonial__icon,
    .swiper-slide:not(.swiper-slide-active) .testimonial__icon,
    .swiper-slide-active .testimonial__icon {
      position: static;
      transform: none;
      color: #d7e0ec;
      @apply text-3xl;
    }

    .testimonial__rating,
    .testimonial__text p {
      display: block;
    }

    .testimonial__rating {
      color: #f5b01b;
      @apply text-sm;
    }

    .testimonial__text p {
      color: var(--color-text);
      @apply text-sm sm:text-base leading-7;
    }

    .testimonial__info {
      @apply mt-auto;
    }

    .s-slider--nav-arrow {
      @apply hidden lg:flex items-center justify-center;
      width: 42px;
      height: 42px;
      border-radius: 9999px;
      border: 1px solid var(--th-testimonials-border);
      background: #fff;
      color: var(--color-gray-text);
      top: 50%;
      transform: translateY(-50%);
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.12);
    }

    .s-slider--nav-arrow.s-slider-prev {
      inset-inline-start: -10px;
      inset-inline-end: auto;
    }

    .s-slider--nav-arrow.s-slider-next {
      inset-inline-end: -10px;
      inset-inline-start: auto;
    }

    .swiper-pagination-bullets.swiper-pagination-horizontal {
      bottom: 8px;
    }

    .swiper-pagination-bullet {
      width: 8px;
      height: 8px;
      border-radius: 9999px;
      background: #cbd5e1;
      opacity: 1;
      transition: width 220ms var(--th-testimonials-ease), background-color 220ms var(--th-testimonials-ease);
    }

    .swiper-pagination-bullet-active {
      width: 24px;
      background: var(--color-primary);
    }
  }

  @media (max-width: 1023px) {
    border-radius: 18px;
    @apply px-2 py-7;

    .testimonials-slider .swiper {
      padding-bottom: 44px !important;
    }
  }

  @media (max-width: 767px) {
    border-radius: 14px;

    .testimonials-slider .s-slider--nav-arrow {
      display: none !important;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .testimonials-slider .testimonial,
    .testimonials-slider .swiper-pagination-bullet {
      transition: none !important;
    }
  }
}

.best-products-slider {
  .swiper-wrapper {
    @media screen and (min-width: 768px) {
      height: 510px;

      .swiper-slide {
        height: calc((100% - 30px) / 2);
      }
    }
  }
}

//general
.swiper-button-disabled {
  opacity: 0.5;
}

// bullet pagination -------
salla-slider {
  .swiper-pagination-bullet {
    width: 20px;
    border-radius: 5px;
    background: #fff;
    opacity: 0.3;

    &-active {
      opacity: 1;
      background-color: var(--color-primary);
    }
  }

  .swiper-pagination-bullets.swiper-pagination-horizontal {
    @apply bottom-3 sm:bottom-6;
  }
}


// Offer slider
.offer-slider .s-slider-block__title {
  @apply mb-5 relative;

  &:before {
    @apply text-5xl font-normal text-red-50 absolute leading-none top-4 rtl:right-0 ltr:left-0;
    content: "\ee30";
    font-family: 'sallaicons';
  }

  h2 {
    @apply text-lg text-red-400;
  }

  p {
    @apply mt-1 leading-6 line-clamp-none;
  }
}

// move to slider component
model-viewer[style*="width"]:before {
  @apply hidden;
}


// Blog slider
.blog-slider {
  .swiper-slide img {
    @apply min-h-[380px] max-h-[480px] md:max-h-[680px];
  }
}

// Custom Scrollbar for Swiper
.scroll-bar {
  @apply relative w-[98%] h-1 bg-gray-200 mt-4 mx-auto rounded overflow-hidden; // Force LTR for consistency if needed, or rely on inset-inline-start

  .scroll-prog {
    @apply absolute top-0 h-full bg-primary rounded transition-all duration-100 ease-linear;
    inset-inline-start: 0; // Starts from right in RTL, left in LTR
    width: 0%;
  }
}
